<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Processes - Jenkins Containers</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="css/extra.css" rel="stylesheet">

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="index.html">Jenkins Containers</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="index.html" class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="layouts.html" class="nav-link">Repo Layouts</a>
                            </li>
                            <li class="navitem active">
                                <a href="processes.html" class="nav-link">Processes</a>
                            </li>
                            <li class="navitem">
                                <a href="philosophy.html" class="nav-link">Build Philosophy</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="layouts.html" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="philosophy.html" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#tagging-commits-in-image-git-repos" class="nav-link">Tagging Commits In Image Git Repos</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#building-jenkins-images" class="nav-link">Building Jenkins Images</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="tagging-commits-in-image-git-repos">Tagging Commits In Image Git Repos</h1>
<ul>
<li>Current versioning schema roughly looks like this: ‘<strong>vx.x.x</strong>’, with <strong>x</strong> being some positive int. Should represent <strong>major.minor.patch</strong>, that being the intent.</li>
<li>When tagging a point in the commit tree, the following process is in place (again, just at a best effort level). This should be followed in <strong><em>descending</em></strong> order, these are known as <strong>rules</strong>:<ol>
<li>If the <strong>Dockerfile</strong> changed as part of a new commit, then the image has changed and the tag should be incremented and assigned to the new commit.</li>
<li>If some part of an image file system has changed (e.g. <strong>casc.yaml</strong> that should be in the <strong>$JENKINS_HOME</strong>), then the most recent tag (e.g. if v1.0.0 and v1.0.1 exist, v1.0.1 would be the most recent tag) should be removed from its previous commit and reassigned to the new commit but not incremented.</li>
<li>If the <strong>Dockerfile</strong> has not changed, and no part of an image’s file system has changed, then no tagging needs to occur with the new commit.<ul>
<li>To follow this <strong>rule</strong>, if a base image changes, the child image does not need to increment/reassign its tag.</li>
<li><strong><em>EXTRA NOTE</em></strong>: Jenkins Images built for a particular version can be from any commit that follows <strong>rule (iii)</strong> up to any other commit that follows <strong>rule (i)</strong>/<strong>rule (ii)</strong>. Any commits existing between them are assumed to follow <strong>rule (iii)</strong> and can be used for that particular version.</li>
</ul>
</li>
</ol>
</li>
<li>Image file system changes &gt; <strong>Dockerfile</strong> changes<ul>
<li>This needs to be brought up because looking at <strong>rule (ii)</strong> in the above procedure list, moving a particular tag to a new commit when its file system has changed means it will be harder to know when that image changed (aka, the tag incremented) when looking through the commit tree.<ul>
<li>Rational is that currently <strong>Dockerfiles</strong> have been skimmed down and the actual image should not change as often as its contents.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="building-jenkins-images">Building Jenkins Images</h1>
<p><strong><em>NOTE: TAGGING COMMITS SHOULD OCCUR FIRST AND BE SORTED OUT! OTHERWISE THERE IS NO GUARANTEE AN IMAGE WILL BE IN LINE WITH ITS IMAGE GIT REPO.</em></strong></p>
<ul>
<li>To make the process of running a <strong>docker build</strong> easier, each <strong>Image Git Repo</strong> should provide a <strong>setup</strong> script that will prepare everything to construct a <strong>Jenkins Image</strong>. This script will more than likely utilize the <strong>jcasc.py</strong> program.<ul>
<li>This serves two fold:<ul>
<li>To provide a blueprint/trail for the ‘<strong>casc.yaml</strong>’ used by the <strong>Jenkins</strong> service in the container. This is so we know how the <strong>casc.yaml</strong> was created. Though again, this isn’t an image change but a <strong>Jenkins</strong> config change (meaning the file system will change with the new <strong>casc.yaml</strong>).</li>
<li>To have fewer keystrokes used...a programmer’s goal ideally.</li>
</ul>
</li>
</ul>
</li>
<li><strong>docker build</strong> works here, though it should be mentioned the <strong>jcasc.py</strong> program does provide a docker-build command that provides some convenience with '--build-args' being already provided where possible.<ul>
<li>If using just <strong>docker build</strong>, currently I also append the follow options (this is for <strong>official builds</strong> anyways):<ul>
<li>--no-cache</li>
<li>--build-arg</li>
<li>BRANCH=<ul>
<li>You will have to assign the current branch the repo is in.</li>
</ul>
</li>
<li>--build-arg</li>
<li>COMMIT=<ul>
<li>You will have to assign a commit that the image was built off of.</li>
</ul>
</li>
<li>--tag</li>
<li>name:tag (<strong>Docker</strong> format for tags)</li>
<li>“.” (the context to send to the <strong>Docker Daemon</strong>)</li>
</ul>
</li>
</ul>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
